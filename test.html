function decodeMessage() {
    var img = document.getElementById('encoded_image');
    var canvas = document.createElement('canvas');
    var ctx = canvas.getContext('2d');

    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0, 0);

    var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    var pixels = imageData.data;

    var message = '';
    var currentCharCode = 0;
    var bitIndex = 0;

    for (var i = 0; i < pixels.length; i += 4) {
        var pixel = pixels.slice(i, i + 4);

        // Retrieve the LSB of each color channel and assemble the characters
        currentCharCode |= ((pixel[0] & 1) << 7);
        currentCharCode |= ((pixel[1] & 1) << 6);
        currentCharCode |= ((pixel[2] & 1) << 5);

        bitIndex += 3;

        if (bitIndex >= 8) {
            message += String.fromCharCode(currentCharCode);
            currentCharCode = 0;
            bitIndex = 0;
        }
    }

    var decodedMessage = document.getElementById('decoded_message');
    decodedMessage.innerText = message;
}
